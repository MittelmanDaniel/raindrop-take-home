// ClickHouse SQL Grammar (converted from official ANTLR grammar)
// Focused on SELECT statements for read-only queries

// ---------- Terminals ----------
IDENTIFIER: /[a-zA-Z_][a-zA-Z0-9_]*/
NUMBER: /[0-9]+/
STRING_LITERAL: /'[^']*'/
FLOATING_LITERAL: /[0-9]+\.[0-9]*([eE][+-]?[0-9]+)?/

// ---------- Punctuation & operators ----------
SP: " "
COMMA: ","
SEMI: ";"
LPAREN: "("
RPAREN: ")"
LBRACKET: "["
RBRACKET: "]"
DOT: "."
GT: ">"
LT: "<"
GTE: ">="
LTE: "<="
EQ: "="
NEQ: "!=" | "<>"
PLUS: "+"
DASH: "-"
ASTERISK: "*"
SLASH: "/"
PERCENT: "%"

// ---------- SQL Keywords ----------
SELECT: "SELECT"
FROM: "FROM"
WHERE: "WHERE"
GROUP: "GROUP"
BY: "BY"
ORDER: "ORDER"
LIMIT: "LIMIT"
HAVING: "HAVING"
AS: "AS"
DISTINCT: "DISTINCT"
AND: "AND"
OR: "OR"
LIKE: "LIKE"
ILIKE: "ILIKE"
IN: "IN"
NOT: "NOT"
IS: "IS"
NULL: "NULL"
ASC: "ASC"
ASCENDING: "ASCENDING"
DESC: "DESC"
DESCENDING: "DESCENDING"
FORMAT: "FORMAT"
JSON: "JSON"
ALL: "ALL"
BETWEEN: "BETWEEN"
CASE: "CASE"
WHEN: "WHEN"
THEN: "THEN"
ELSE: "ELSE"
END: "END"
CAST: "CAST"
ASOF: "ASOF"
GLOBAL: "GLOBAL"
PREWHERE: "PREWHERE"
WITH: "WITH"
SAMPLE: "SAMPLE"
OFFSET: "OFFSET"
UNION: "UNION"
EXCEPT: "EXCEPT"
INTERSECT: "INTERSECT"
CUBE: "CUBE"
ROLLUP: "ROLLUP"
TOTALS: "TOTALS"
FIRST: "FIRST"
LAST: "LAST"
NULLS: "NULLS"
TIES: "TIES"

// ---------- Main query structure ----------
start: select_stmt SP FORMAT SP JSON [SEMI]

select_stmt: SELECT [DISTINCT] [ALL] select_elements FROM table_sources [prewhere_clause] [where_clause] [group_by_clause] [having_clause] [order_by_clause] [limit_clause] [offset_clause]

// ---------- Select elements ----------
select_elements: ASTERISK | select_element (COMMA SP select_element)*
select_element: column_expr [SP alias_clause]
alias_clause: AS SP identifier | identifier

// ---------- Column expressions (simplified but more complete) ----------
column_expr: column_identifier
           | aggregate_func
           | function_call
           | literal
           | column_expr SP arithmetic_op SP column_expr
           | column_expr SP comparison_op SP column_expr
           | column_expr SP logical_op SP column_expr
           | column_expr SP IS SP [NOT SP] NULL
           | column_expr SP [NOT SP] (LIKE | ILIKE) SP STRING_LITERAL
           | column_expr SP [NOT SP] [GLOBAL SP] IN SP LPAREN (value_list | select_stmt) RPAREN
           | column_expr SP BETWEEN SP column_expr SP AND SP column_expr
           | CASE [SP column_expr] SP when_clause+ [SP ELSE SP column_expr] SP END
           | CAST LPAREN SP column_expr SP AS SP data_type SP RPAREN
           | LPAREN column_expr RPAREN

column_identifier: [table_name DOT] identifier

// ---------- Functions ----------
function_call: identifier LPAREN SP function_args SP RPAREN
             | identifier LPAREN SP DISTINCT SP function_args SP RPAREN
             | identifier LPAREN RPAREN
function_args: column_expr (COMMA SP column_expr)*

aggregate_func: count_func | sum_func | avg_func | min_func | max_func | group_concat_func
count_func: "count" LPAREN SP ASTERISK SP RPAREN
           | "count" LPAREN SP DISTINCT SP column_expr SP RPAREN
           | "count" LPAREN RPAREN
sum_func: "sum" LPAREN [SP] column_expr [SP] RPAREN
avg_func: "avg" LPAREN [SP] column_expr [SP] RPAREN
min_func: "min" LPAREN [SP] column_expr [SP] RPAREN
max_func: "max" LPAREN [SP] column_expr [SP] RPAREN
group_concat_func: "groupArray" LPAREN [SP] column_expr [SP] RPAREN

// ---------- Table sources ----------
table_sources: table_source (COMMA SP table_source)*
table_source: table_name [SP alias_clause]

// Fixed table name for this use case
table_name: "IBM_HR_Employee_Attrition"

// ---------- Clauses ----------
prewhere_clause: PREWHERE SP column_expr
where_clause: WHERE SP column_expr
group_by_clause: GROUP SP BY SP group_by_list [SP WITH SP (CUBE | ROLLUP | TOTALS)]
group_by_list: column_expr (COMMA SP column_expr)*
having_clause: HAVING SP column_expr
order_by_clause: ORDER SP BY SP order_by_list
order_by_list: order_by_item (COMMA SP order_by_item)*
order_by_item: column_expr [SP (ASC | ASCENDING | DESC | DESCENDING)] [SP NULLS SP (FIRST | LAST)]
limit_clause: LIMIT SP NUMBER [SP BY SP column_expr_list] [SP WITH SP TIES]
offset_clause: OFFSET SP NUMBER
column_expr_list: column_expr (COMMA SP column_expr)*

// ---------- Operators ----------
arithmetic_op: PLUS | DASH | ASTERISK | SLASH | PERCENT
comparison_op: EQ | NEQ | GT | LT | GTE | LTE
logical_op: AND | OR

// ---------- Case expressions ----------
when_clause: WHEN SP column_expr SP THEN SP column_expr

// ---------- Literals and values ----------
literal: NUMBER | FLOATING_LITERAL | STRING_LITERAL | NULL
value_list: literal (COMMA SP literal)*

// ---------- Data types (simplified) ----------
data_type: "Int8" | "Int16" | "Int32" | "Int64"
         | "UInt8" | "UInt16" | "UInt32" | "UInt64"
         | "Float32" | "Float64"
         | "String" | "FixedString" LPAREN SP NUMBER SP RPAREN
         | "Date" | "DateTime" | "DateTime64"
         | "UUID" | "Array" LPAREN SP data_type SP RPAREN

identifier: IDENTIFIER
